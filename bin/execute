#!/bin/bash
constant=''

while getopts 'c:' opt; do
    case "${opt}" in
        c)
            constant="${OPTARG}"
            ;;
    esac
done

shift "$(expr "${OPTIND}" - 1)"

image="${1}"

if [ -n "${constant}" ]; then
    echo "Executing docker run -d "${image}" /tmp/execute -c "${constant}" /tmp/userScript" >&2
    containerId="$(docker run -d "${image}" /tmp/execute -c "${constant}" /tmp/userScript)"
else
    containerId="$(docker run -d "${image}" /tmp/execute /tmp/userScript)"
fi
exitStatus="$(docker wait "${containerId}")"
docker logs "${containerId}"
